context("Testing function initialize_genotypeR_data")

source("test_data_generator.R")

genotype_table <- Ref_Alt_Table(make_marker_names(fake_markers))

fake_geno_data <- initialize_genotypeR_data(seq_data=genotypes_data, genotype_table=genotype_table, warning_allele="Ref", output="warnings2NA")

##get expectation
##dcast(SAMPLE_NAME+WELL~MARKER, value.var =  "GENOTYPE", data=genotypes(fake_geno_data))
##naive_CO <- list(c(0,1,0,1), c(0,0,0,0), c(0,0,0,0), c(0,0,0,0), c(0,0,0,0))
##non_naive_CO <- list(c(0,1,0.5,0.5), c(0,0,0,0), c(0,0,0,0), c(0,0,0,0), c(0,0,0,0))

fake_geno_binary <- binary_coding(fake_geno_data, genotype_table=genotype_table)

non_naive_fake_geno_CO <- count_CO(fake_geno_binary, naive=FALSE)

test_that("initialize_genotypeR produces the right class", {    

    expect_is(non_naive_fake_geno_CO, "genotypeR")
    
})
